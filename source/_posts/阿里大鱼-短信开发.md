title: 阿里大鱼API开发
date: 2016-03-16 21:05:26
tags: [PHP,API,阿里大鱼,短信]
categories: [阿里大鱼]
---
> 最近这段时间我比较忙,学习CI框架,看团队的login,register的代码,看的东西比较多,但是动手写的代码却少了,今天比较有空,就来总结下我写的短信开发api.

# 一、注册阿里开发者
1. 点击 [阿里大鱼](http://www.alidayu.com)
2. 通过淘宝账号登陆
	完成实名认证
3. 通过后,它会送你￥60的代金券,够你玩一阵了,0.06/条的短信,够你发1000条了。

# 二、基本配置
1. [阿里大鱼](http://www.alidayu.com)这里点击->管理中心(在完成了认证之后!)
2. 管理中心进入后,在最上面的导航栏点击开发者控制台
3. 创建应用(根据需要)
> 这前面的步骤主要是为了获得key和secret;
4. 创建好了之后,下载你需要的sdk版本;

# 三、申请自己的短信签名和模板
> 点击[阿里大鱼](http://www.alidayu.com)->管理中心->左边的导航栏中,有短信签名管理,短信模板管理,可以直接添加；
短信签名,必须在这里申请了,然后代码中才能使用
短信模板,要使用它的模板ID,在代码中使用

# 四、开发端完成代码
> 这里基于是CI框架的开发
首先将下载好的sdk放在library下面

``` php
public function alidayu(){
	$telephone = $this->input->post('mobile');//接收电话号码
	$codes = mt_rand(100000,999999);//验证码
	$appkey = '';//这里主要看你的应用的
	$secret = '';//这里可以在应用里面查看
	$signName = '';//短信签名
	$tempCode = '';//短信模板id

	// 构造json类型的字符串,貌似他不接受json类型,所以不能直接用json_encode
	$param = "{'code:'".$codes."}";
	// 加载sdk的短信类
	$this->load->library('taobao/top/TopClient');
    $this->load->library('taobao/top/ResultSet');
    $this->load->library('taobao/top/RequestCheckUtil');
    $this->load->library('taobao/top/TopLogger');
    $this->load->library('taobao/top/request/AlibabaAliqinFcSmsNumSendRequest');

    $c = new TopClient;
    $c->appkey = $appkey;
    $c->secretKey = $secret;
    $req = new AlibabaAliqinFcSmsNumSendRequest;
    // $req->setExtend('123456');// 这个是可选项,用处不太明白,所以先不用
    $req->setSmsType('normal');//短信类型,normal就可以了
    $req->setSmsFreeSignName($signNmae);//短信签名;
    $req->setSmsParam($param);//参数,json类型的字符串

    $req->setRecNum($telephone);//短信接收号码
    $req->setSmsTemplateCode($tempCode);//管理中心->短信模板管理

    $resp = $c->execute($req);
}
```

# 总结：虽然这个api并不是很难,但是这毕竟是自己第一次完成的一个接口调用,所以还是很有成就感的,从以前的只会看视频的人,到现在慢慢强迫自己去看开发文档,我觉得这条路虽然很难,但是只要自己还有兴趣,自己还回去拼,就会有回报的!